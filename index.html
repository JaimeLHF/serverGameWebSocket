<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Game WebSocket</title>
    <style>
        /* Seu CSS */
    </style>
</head>

<body>
    <h1>Welcome to Server Game WebSocket</h1>
    <div>
        <p id="userCont">You : <span id="user"></span></p>
        <p id="opponentCont">Opponent : <span id="opponent"></span></p>
    </div>
    <br>
    <p id="valueCont">You are playing as <span id="value"></span></p>
    <br>
    <p id="whosTurn">X's Turn</p>
    <div>
        <p id="enterName">Enter your Name:</p>
        <input type="text" id="name" placeholder="Enter your name">
        <button id="find">Search for a player</button>

        <div id="bigCont">
            <div id="cont">
                <button id="btn1" class="btn"></button>
                <button id="btn2" class="btn"></button>
                <button id="btn3" class="btn"></button>
                <button id="btn4" class="btn"></button>
                <button id="btn5" class="btn"></button>
                <button id="btn6" class="btn"></button>
                <button id="btn7" class="btn"></button>
                <button id="btn8" class="btn"></button>
                <button id="btn9" class="btn"></button>
            </div>
        </div>
    </div>
</body>
<script>
    document.getElementById("bigCont").style.display = "none";
    document.getElementById("userCont").style.display = "none";
    document.getElementById("opponentCont").style.display = "none";
    document.getElementById("valueCont").style.display = "none";
    document.getElementById("whosTurn").style.display = "none";

    const socket = io();

    let name;

    document.getElementById("find").addEventListener("click", () => {
        name = document.getElementById("name").value;

        document.getElementById("user").innerText = name;

        if (name == null || name == '') {
            alert("Please enter your name");
            return;
        } else {
            socket.emit("find", name);
            document.getElementById("find").disabled = true;
        }
    });

    socket.on("find", (e) => {
        let allPlayersArray = e.allPlayers;
        console.log(allPlayersArray);
        document.getElementById("userCont").style.display = "block";
        document.getElementById("opponentCont").style.display = "block";
        document.getElementById("valueCont").style.display = "block";
        document.getElementById("name").style.display = "none";
        document.getElementById("find").style.display = "none";
        document.getElementById("enterName").style.display = "none";
        document.getElementById("bigCont").style.display = "block";
        document.getElementById("whosTurn").style.display = "block";
        document.getElementById("whosTurn").innerText = "X's Turn";

        let oppName;
        let value;

        const foundObj = allPlayersArray.find(obj => obj.p1.p1name == `${name}` || obj.p2.p2name == `${name}`);

        foundObj.p1.p1name == `${name}` ? (oppName = foundObj.p2.p2name, value = "X") : (oppName = foundObj.p1.p1name, value = "O");

        document.getElementById("opponent").innerText = oppName;
        document.getElementById("value").innerText = value;
    });
</script>


</html>